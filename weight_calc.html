<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minecraft Weights Percentage Calculator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        table, th, td {
            border: 1px solid #ccc;
        }
        th, td {
            padding: 10px;
            text-align: left;
        }
        th {
            background-color: #f4f4f4;
        }
        textarea {
            width: 100%;
        }
        input[type="number"] {
            width: 60px;
        }
    </style>
</head>
<body>
    <h1>Minecraft Weights Percentage Calculator</h1>
    
    <form id="jsonForm">
        <label for="jsonInput">Enter Minecraft loot table JSON:</label><br>
        <textarea id="jsonInput" rows="15" placeholder='{ "pools": [ ... ] }'></textarea><br><br>
        <button type="button" onclick="calculateFromJSON()">Load and Calculate</button>
    </form>

    <h2>Results</h2>
    <table id="resultTable">
        <thead>
            <tr>
                <th>Item</th>
                <th>Weight</th>
                <th>Percentage (%)</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>

    <button type="button" onclick="recalculatePercentages()">Recalculate Percentages</button>

    <script>
        let items = [];

        function calculateFromJSON() {
            const jsonInput = document.getElementById('jsonInput').value;
            let lootTable;
            try {
                lootTable = JSON.parse(jsonInput);
            } catch (e) {
                alert("Invalid JSON format!");
                return;
            }

            const entries = lootTable.pools[0].entries;
            items = [];
            let totalWeight = 0;

            for (const entry of entries) {
                const item = entry.name.split(':')[1];
                const weight = entry.weight;
                items.push({ item, weight });
                totalWeight += weight;
            }

            populateTable();
            recalculatePercentages();
        }

        function populateTable() {
            const resultTable = document.getElementById('resultTable').getElementsByTagName('tbody')[0];
            resultTable.innerHTML = '';

            for (let i = 0; i < items.length; i++) {
                const row = resultTable.insertRow();
                row.insertCell(0).textContent = items[i].item;

                const weightCell = row.insertCell(1);
                const weightInput = document.createElement('input');
                weightInput.type = 'number';
                weightInput.value = items[i].weight;
                weightInput.dataset.index = i;
                weightCell.appendChild(weightInput);

                row.insertCell(2).textContent = '';
            }
        }

        function recalculatePercentages() {
            let totalWeight = 0;

            // Update weights based on user input
            const inputs = document.querySelectorAll('input[type="number"]');
            for (const input of inputs) {
                const index = input.dataset.index;
                const newWeight = parseInt(input.value, 10);
                items[index].weight = isNaN(newWeight) ? 0 : newWeight;
                totalWeight += items[index].weight;
            }

            // Calculate percentages and update the table
            const resultTable = document.getElementById('resultTable').getElementsByTagName('tbody')[0];
            for (let i = 0; i < items.length; i++) {
                const percentage = totalWeight === 0 ? 0 : ((items[i].weight / totalWeight) * 100).toFixed(2);
                resultTable.rows[i].cells[2].textContent = percentage;
            }
        }
    </script>
</body>
</html>
